---
phase: 45-slider-fixes
plan: 02
type: execute
wave: 2
depends_on: ["45-01"]
files_modified:
  - src/components/elements/renderers/controls/BipolarSliderRenderer.tsx
  - src/components/Properties/BipolarSliderProperties.tsx
  - src/types/elements/controls.ts
  - src/components/elements/renderers/controls/ArcSliderRenderer.tsx
  - src/components/Properties/ArcSliderProperties.tsx
autonomous: true

must_haves:
  truths:
    - "Bipolar Slider has two configurable zone colors for negative and positive regions"
    - "Bipolar Slider center snap is configurable via property panel"
    - "Arc Slider label distance is configurable and clearly visible in property panel"
    - "Arc Slider value distance is configurable and clearly visible in property panel"
  artifacts:
    - path: "src/types/elements/controls.ts"
      provides: "negativeFillColor, positiveFillColor, centerSnap properties for BipolarSliderElementConfig"
      contains: "negativeFillColor"
    - path: "src/components/elements/renderers/controls/BipolarSliderRenderer.tsx"
      provides: "Two-color zone rendering"
      contains: "negativeFillColor"
    - path: "src/components/Properties/BipolarSliderProperties.tsx"
      provides: "Zone color and center snap controls"
      contains: "negativeFillColor"
  key_links:
    - from: "BipolarSliderRenderer.tsx"
      to: "config.negativeFillColor"
      via: "conditional fill color"
      pattern: "normalizedValue.*centerValue.*negativeFillColor"
---

<objective>
Add configuration options for Bipolar Slider zone colors and verify Arc Slider distance discoverability.

Purpose: Enhance Bipolar Slider with two-color zones per user decision (GitHub #33), and verify Arc Slider distance options are discoverable (GitHub #36 - feature exists but may have UX issue).

Output: Bipolar Slider with separate negative/positive zone colors and center snap toggle. Arc Slider with verified distance controls.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/45-slider-fixes/45-CONTEXT.md
@.planning/phases/45-slider-fixes/45-RESEARCH.md
@src/components/elements/renderers/controls/BipolarSliderRenderer.tsx
@src/components/Properties/BipolarSliderProperties.tsx
@src/components/elements/renderers/controls/ArcSliderRenderer.tsx
@src/components/Properties/ArcSliderProperties.tsx
@src/types/elements/controls.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Bipolar Slider zone colors and center snap</name>
  <files>
    src/types/elements/controls.ts
    src/components/elements/renderers/controls/BipolarSliderRenderer.tsx
    src/components/Properties/BipolarSliderProperties.tsx
  </files>
  <action>
Implement two-color zones and center snap for Bipolar Slider per user decisions:

1. **Type definition** (controls.ts - BipolarSliderElementConfig):
   Add new properties:
   ```typescript
   // Zone Colors (replaces single trackFillColor for zones)
   negativeFillColor: string  // Color when value < centerValue
   positiveFillColor: string  // Color when value >= centerValue

   // Center Snap
   centerSnap: boolean  // Enable/disable snap to center
   centerSnapThreshold: number  // Threshold in normalized value (default 0.02 = 2%)
   ```

   Keep existing `trackFillColor` as fallback for backward compatibility.

2. **Factory update** (createBipolarSlider):
   ```typescript
   negativeFillColor: '#ef4444',  // Red-ish for negative
   positiveFillColor: '#22c55e',  // Green-ish for positive
   centerSnap: false,
   centerSnapThreshold: 0.02,
   ```

3. **Renderer update** (BipolarSliderRenderer.tsx):
   - Determine fill color based on position relative to center:
     ```typescript
     const fillColor = normalizedValue >= centerValue
       ? (config.positiveFillColor ?? config.trackFillColor)
       : (config.negativeFillColor ?? config.trackFillColor)
     ```
   - Apply to both vertical and horizontal branches
   - Note: Center snap affects interaction (plan 03), but renderer should read value correctly

4. **Property panel update** (BipolarSliderProperties.tsx):
   - Add "Zone Colors" section:
     - ColorInput for "Negative Zone Color" (negativeFillColor)
     - ColorInput for "Positive Zone Color" (positiveFillColor)
   - Add checkbox "Enable Center Snap" (centerSnap) in Center section
   - Add NumberInput for "Snap Threshold %" when centerSnap is true (centerSnapThreshold * 100, display as percentage)
  </action>
  <verify>
    - `npm run build` succeeds
    - Add Bipolar Slider to canvas
    - Set value below center -> fill shows negative color
    - Set value above center -> fill shows positive color
    - Zone Colors section visible in property panel with two color pickers
    - Center Snap checkbox visible and functional
  </verify>
  <done>
    - Bipolar Slider displays different colors for negative/positive zones
    - Center snap toggle available in property panel
    - Backward compatible (old projects use trackFillColor as fallback)
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify and enhance Arc Slider distance discoverability</name>
  <files>
    src/components/Properties/ArcSliderProperties.tsx
    src/components/elements/renderers/controls/ArcSliderRenderer.tsx
    src/types/elements/controls.ts
  </files>
  <action>
Research found labelDistance and valueDistance ALREADY EXIST. GitHub #36 may be UX/discoverability issue. Verify and enhance:

1. **Verify existing implementation**:
   - Type: labelDistance (line 571), valueDistance (line 580) - CONFIRMED
   - Renderer: uses config.labelDistance ?? 4, config.valueDistance ?? 4 - CONFIRMED
   - Property panel: passes labelDistance/valueDistance to shared sections - CONFIRMED
   - Default factory: labelDistance: 4, valueDistance: 4 - CONFIRMED

2. **Check shared section** (src/components/Properties/shared/LabelDisplaySection.tsx and ValueDisplaySection.tsx):
   - Verify distance inputs are rendered
   - Check if inputs are conditionally hidden (only when showLabel/showValue is true?)
   - Ensure input labels are clear: "Label Distance (px)" not just "Distance"

3. **Enhance if needed**:
   - Increase default distance to 8px (per user decision: 8-10px gap)
   - Update default factory in controls.ts:
     ```typescript
     labelDistance: 8,  // was 4
     valueDistance: 8,  // was 4
     ```
   - Add explicit "px" unit hint in label if not present

4. **Test discoverability**:
   - Add Arc Slider to canvas
   - Enable Show Label and Show Value
   - Confirm distance inputs appear in property panel
   - Adjust distance values and verify labels/values move
  </action>
  <verify>
    - Arc Slider distance controls visible when label/value enabled
    - Changing distance moves label/value further from arc
    - Default distance is 8px (more noticeable than 4px)
    - Property panel clearly shows "Label Distance (px)" and "Value Distance (px)"
  </verify>
  <done>
    - Arc Slider distance options verified working
    - Default distance increased to 8px for better visibility
    - GitHub #36 addressed (feature exists, UX improved)
  </done>
</task>

</tasks>

<verification>
1. `npm run build` - no TypeScript errors
2. Visual verification:
   - Bipolar Slider: two-color zones visible based on value position
   - Arc Slider: distance controls work, default provides visible spacing
3. Property panel: all new controls accessible
</verification>

<success_criteria>
- SLD-02 (Arc Slider distance options): Distance controls discoverable and working
- SLD-04 enhancement (Bipolar zone colors): Two-color zones implemented
- Backward compatibility maintained for existing projects
</success_criteria>

<output>
After completion, create `.planning/phases/45-slider-fixes/45-02-SUMMARY.md`
</output>
