---
phase: 19-architecture-refactoring
plan: 05
type: execute
wave: 3
depends_on: ["19-02", "19-03"]
files_modified:
  - src/components/elements/renderers/controls/KnobRenderer.tsx
  - src/components/elements/renderers/controls/SliderRenderer.tsx
  - src/components/elements/renderers/controls/ButtonRenderer.tsx
  - src/components/elements/renderers/controls/index.ts
  - src/components/elements/renderers/displays/LabelRenderer.tsx
  - src/components/elements/renderers/displays/MeterRenderer.tsx
  - src/components/elements/renderers/displays/index.ts
  - src/components/elements/renderers/containers/PanelRenderer.tsx
  - src/components/elements/renderers/containers/index.ts
  - src/components/elements/renderers/decorative/RectangleRenderer.tsx
  - src/components/elements/renderers/decorative/index.ts
  - src/components/elements/renderers/index.ts
autonomous: false

must_haves:
  truths:
    - "Renderers organized by category: controls/, displays/, containers/, decorative/"
    - "All imports through category index files work correctly"
    - "Registry imports updated to use category paths"
  artifacts:
    - path: "src/components/elements/renderers/controls/index.ts"
      provides: "Control renderer exports"
      exports: ["KnobRenderer", "SliderRenderer", "ButtonRenderer"]
    - path: "src/components/elements/renderers/displays/index.ts"
      provides: "Display renderer exports"
      exports: ["LabelRenderer", "MeterRenderer"]
  key_links:
    - from: "src/components/elements/renderers/index.ts"
      to: "src/components/elements/renderers/*/index.ts"
      via: "imports from category folders"
      pattern: "from './controls'"
---

<objective>
Restructure renderer file organization by moving them into category-based subdirectories aligned with the type system.

Purpose: With 25+ element types (growing to 100+), flat file organization becomes unwieldy. Category folders (controls/, displays/, containers/, decorative/) match the type system structure and prepare for code splitting.

Output: Renderer components organized by category with proper index.ts exports.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/19-architecture-refactoring/19-RESEARCH.md
@.planning/phases/19-architecture-refactoring/19-02-SUMMARY.md
@.planning/phases/19-architecture-refactoring/19-03-SUMMARY.md
@src/components/elements/renderers/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Organize renderer files by category</name>
  <files>
    src/components/elements/renderers/controls/index.ts
    src/components/elements/renderers/displays/index.ts
    src/components/elements/renderers/containers/index.ts
    src/components/elements/renderers/decorative/index.ts
    src/components/elements/renderers/index.ts
  </files>
  <action>
Create category subdirectories and move renderer files.

1. Create directories:
```bash
mkdir -p src/components/elements/renderers/controls
mkdir -p src/components/elements/renderers/displays
mkdir -p src/components/elements/renderers/containers
mkdir -p src/components/elements/renderers/decorative
```

2. Move renderer files to categories:

**controls/** (8 files):
- KnobRenderer.tsx
- SliderRenderer.tsx
- ButtonRenderer.tsx
- RangeSliderRenderer.tsx
- DropdownRenderer.tsx
- CheckboxRenderer.tsx
- RadioGroupRenderer.tsx
- TextFieldRenderer.tsx

**displays/** (9 files):
- LabelRenderer.tsx
- MeterRenderer.tsx
- DbDisplayRenderer.tsx
- FrequencyDisplayRenderer.tsx
- GainReductionMeterRenderer.tsx
- WaveformRenderer.tsx
- OscilloscopeRenderer.tsx
- PresetBrowserRenderer.tsx
- ModulationMatrixRenderer.tsx

**containers/** (4 files):
- PanelRenderer.tsx
- FrameRenderer.tsx
- GroupBoxRenderer.tsx
- CollapsibleRenderer.tsx

**decorative/** (4 files):
- ImageRenderer.tsx
- SvgGraphicRenderer.tsx
- RectangleRenderer.tsx
- LineRenderer.tsx

3. Create category index.ts files:

**controls/index.ts**:
```typescript
export { KnobRenderer } from './KnobRenderer'
export { SliderRenderer } from './SliderRenderer'
export { ButtonRenderer } from './ButtonRenderer'
export { RangeSliderRenderer } from './RangeSliderRenderer'
export { DropdownRenderer } from './DropdownRenderer'
export { CheckboxRenderer } from './CheckboxRenderer'
export { RadioGroupRenderer } from './RadioGroupRenderer'
export { TextFieldRenderer } from './TextFieldRenderer'
```

**displays/index.ts**:
```typescript
export { LabelRenderer } from './LabelRenderer'
export { MeterRenderer } from './MeterRenderer'
export { DbDisplayRenderer } from './DbDisplayRenderer'
export { FrequencyDisplayRenderer } from './FrequencyDisplayRenderer'
export { GainReductionMeterRenderer } from './GainReductionMeterRenderer'
export { WaveformRenderer } from './WaveformRenderer'
export { OscilloscopeRenderer } from './OscilloscopeRenderer'
export { PresetBrowserRenderer } from './PresetBrowserRenderer'
export { ModulationMatrixRenderer } from './ModulationMatrixRenderer'
```

**containers/index.ts**:
```typescript
export { PanelRenderer } from './PanelRenderer'
export { FrameRenderer } from './FrameRenderer'
export { GroupBoxRenderer } from './GroupBoxRenderer'
export { CollapsibleRenderer } from './CollapsibleRenderer'
```

**decorative/index.ts**:
```typescript
export { ImageRenderer } from './ImageRenderer'
export { SvgGraphicRenderer } from './SvgGraphicRenderer'
export { RectangleRenderer } from './RectangleRenderer'
export { LineRenderer } from './LineRenderer'
```

4. Update main renderers/index.ts to import from categories:
```typescript
/**
 * Element Renderer Registry
 */
import React from 'react'
import type { ElementConfig } from '../../../types/elements'

// Import all renderers from category folders
import {
  KnobRenderer,
  SliderRenderer,
  ButtonRenderer,
  RangeSliderRenderer,
  DropdownRenderer,
  CheckboxRenderer,
  RadioGroupRenderer,
  TextFieldRenderer,
} from './controls'

import {
  LabelRenderer,
  MeterRenderer,
  DbDisplayRenderer,
  FrequencyDisplayRenderer,
  GainReductionMeterRenderer,
  WaveformRenderer,
  OscilloscopeRenderer,
  PresetBrowserRenderer,
  ModulationMatrixRenderer,
} from './displays'

import {
  PanelRenderer,
  FrameRenderer,
  GroupBoxRenderer,
  CollapsibleRenderer,
} from './containers'

import {
  ImageRenderer,
  SvgGraphicRenderer,
  RectangleRenderer,
  LineRenderer,
} from './decorative'

// Renderer component type
export type RendererComponent = React.ComponentType<{ config: ElementConfig }>

// Registry mapping element types to renderers
export const rendererRegistry = new Map<ElementConfig['type'], RendererComponent>([
  // Controls
  ['knob', KnobRenderer as RendererComponent],
  ['slider', SliderRenderer as RendererComponent],
  ['button', ButtonRenderer as RendererComponent],
  ['rangeslider', RangeSliderRenderer as RendererComponent],
  ['dropdown', DropdownRenderer as RendererComponent],
  ['checkbox', CheckboxRenderer as RendererComponent],
  ['radiogroup', RadioGroupRenderer as RendererComponent],
  ['textfield', TextFieldRenderer as RendererComponent],

  // Displays
  ['label', LabelRenderer as RendererComponent],
  ['meter', MeterRenderer as RendererComponent],
  ['dbdisplay', DbDisplayRenderer as RendererComponent],
  ['frequencydisplay', FrequencyDisplayRenderer as RendererComponent],
  ['gainreductionmeter', GainReductionMeterRenderer as RendererComponent],
  ['waveform', WaveformRenderer as RendererComponent],
  ['oscilloscope', OscilloscopeRenderer as RendererComponent],
  ['presetbrowser', PresetBrowserRenderer as RendererComponent],
  ['modulationmatrix', ModulationMatrixRenderer as RendererComponent],

  // Containers
  ['panel', PanelRenderer as RendererComponent],
  ['frame', FrameRenderer as RendererComponent],
  ['groupbox', GroupBoxRenderer as RendererComponent],
  ['collapsible', CollapsibleRenderer as RendererComponent],

  // Decorative
  ['image', ImageRenderer as RendererComponent],
  ['svggraphic', SvgGraphicRenderer as RendererComponent],
  ['rectangle', RectangleRenderer as RendererComponent],
  ['line', LineRenderer as RendererComponent],
])

export function getRenderer(type: ElementConfig['type']): RendererComponent | undefined {
  return rendererRegistry.get(type)
}
```

5. Update import paths in moved renderer files:
- Change `from '../../../types/elements'` to `from '../../../../types/elements'`
- Change `from '../../../store'` to `from '../../../../store'`
- Adjust other relative imports as needed
  </action>
  <verify>TypeScript compiles and elements render: `npm run build && npm run dev`</verify>
  <done>Renderer files organized by category with working imports</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Moved 25 renderer files into category subdirectories and updated all import paths</what-built>
  <how-to-verify>
    1. Run `npm run dev` and open the application
    2. Add one element from each category to the canvas:
       - Control: Drag a Knob onto canvas
       - Display: Drag a Label onto canvas
       - Container: Drag a Panel onto canvas
       - Decorative: Drag a Rectangle onto canvas
    3. Verify all four elements render correctly
    4. Verify no console errors appear
    5. Select each element and confirm property panel appears
  </how-to-verify>
  <resume-signal>Type "approved" if all elements render correctly, or describe which elements fail</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` passes without errors
2. `npm run dev` - application starts
3. All 25 element types render correctly on canvas
4. File structure shows category folders:
   - src/components/elements/renderers/{controls,displays,containers,decorative}/
</verification>

<success_criteria>
- [ ] Renderer files moved to category subdirectories
- [ ] Each category has index.ts with re-exports
- [ ] Main index.ts imports from categories
- [ ] All relative imports updated correctly
- [ ] Build passes without TypeScript errors
- [ ] Application functions identically to before reorganization
</success_criteria>

<output>
After completion, create `.planning/phases/19-architecture-refactoring/19-05-SUMMARY.md`
</output>
