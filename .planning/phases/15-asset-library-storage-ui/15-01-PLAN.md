---
phase: 15-asset-library-storage-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/store/assetsSlice.ts
  - src/store/index.ts
  - src/types/asset.ts
autonomous: true

must_haves:
  truths:
    - "Asset type defines id, name, svgContent, categories, fileSize, elementCount, createdAt fields"
    - "AssetsSlice provides addAsset, removeAsset, updateAsset, getAsset, getAssetsByCategory actions"
    - "Store exports AssetsSlice and includes it in combined type"
  artifacts:
    - path: "src/types/asset.ts"
      provides: "Asset interface definition"
      exports: ["Asset"]
    - path: "src/store/assetsSlice.ts"
      provides: "Zustand slice for asset management"
      exports: ["AssetsSlice", "createAssetsSlice"]
    - path: "src/store/index.ts"
      provides: "Combined store with AssetsSlice"
      contains: "createAssetsSlice"
  key_links:
    - from: "src/store/index.ts"
      to: "src/store/assetsSlice.ts"
      via: "import and spread into store"
      pattern: "createAssetsSlice"
---

<objective>
Create the Zustand AssetsSlice for normalized SVG asset storage.

Purpose: Establish the state management foundation that all other asset library features will build upon. This slice follows the existing elementsSlice pattern and provides CRUD operations for SVG assets.

Output: Asset type definition, AssetsSlice with state and actions, integrated into combined store.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-asset-library-storage-ui/15-CONTEXT.md
@.planning/phases/15-asset-library-storage-ui/15-RESEARCH.md
@src/store/index.ts
@src/store/elementsSlice.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Asset type definition</name>
  <files>src/types/asset.ts</files>
  <action>
Create Asset interface with normalized structure from RESEARCH.md:

```typescript
export interface Asset {
  id: string                    // crypto.randomUUID()
  name: string                  // User-editable name
  svgContent: string            // Sanitized SVG markup
  categories: string[]          // Multi-category tags (e.g., ["logo", "icon"])
  fileSize: number              // In bytes
  elementCount: number          // Number of SVG child elements
  createdAt: number             // Timestamp (Date.now())
}
```

Also export default category constants:

```typescript
export const DEFAULT_CATEGORIES = ['logo', 'icon', 'decoration', 'background'] as const
export type DefaultCategory = typeof DEFAULT_CATEGORIES[number]
```
  </action>
  <verify>`npx tsc --noEmit` passes with no errors</verify>
  <done>Asset interface exported from src/types/asset.ts with all required fields</done>
</task>

<task type="auto">
  <name>Task 2: Create AssetsSlice with CRUD actions</name>
  <files>src/store/assetsSlice.ts</files>
  <action>
Create AssetsSlice following existing elementsSlice pattern:

Interface:
```typescript
export interface AssetsSlice {
  // State
  assets: Asset[]
  customCategories: string[]  // User-added categories beyond defaults

  // Actions
  addAsset: (asset: Omit<Asset, 'id' | 'createdAt'>) => void
  removeAsset: (id: string) => void
  updateAsset: (id: string, updates: Partial<Asset>) => void
  getAsset: (id: string) => Asset | undefined
  getAssetsByCategory: (category: string) => Asset[]
  addCustomCategory: (category: string) => void
  removeCustomCategory: (category: string) => void
}
```

Implementation notes:
- Use `crypto.randomUUID()` for id generation (not nanoid)
- Use `Date.now()` for createdAt timestamp
- `getAssetsByCategory` filters assets array where categories includes the category
- Store only flat assets array, derive category groupings on-the-fly
- Follow immutable update patterns (spread operators, filter, map)
  </action>
  <verify>`npx tsc --noEmit` passes with no errors</verify>
  <done>AssetsSlice exports createAssetsSlice function with all CRUD actions</done>
</task>

<task type="auto">
  <name>Task 3: Integrate AssetsSlice into combined store</name>
  <files>src/store/index.ts</files>
  <action>
Update store/index.ts to include AssetsSlice:

1. Import AssetsSlice and createAssetsSlice from './assetsSlice'
2. Add AssetsSlice to Store type union
3. Spread createAssetsSlice into store creator
4. Decide on temporal (undo/redo) behavior:
   - INCLUDE assets in undo history (user may want to undo accidental deletion)
   - Do NOT exclude assets from partialize function

Update combined store type:
```typescript
export type Store = CanvasSlice & ViewportSlice & ElementsSlice & TemplateSlice & AssetsSlice
```

Spread into store:
```typescript
export const useStore = create<Store>()(
  temporal(
    (...a) => ({
      ...createCanvasSlice(...a),
      ...createViewportSlice(...a),
      ...createElementsSlice(...a),
      ...createTemplateSlice(...a),
      ...createAssetsSlice(...a),  // Add new slice
    }),
    { /* existing temporal config */ }
  )
)
```
  </action>
  <verify>`npm run dev` starts without errors; `npx tsc --noEmit` passes</verify>
  <done>Store type includes AssetsSlice, useStore provides asset actions</done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npx tsc --noEmit`
2. Dev server starts: `npm run dev` (no console errors)
3. Asset type has all required fields: id, name, svgContent, categories, fileSize, elementCount, createdAt
4. Store exports useStore with asset actions accessible
</verification>

<success_criteria>
- Asset interface defined with all 7 fields from RESEARCH.md
- AssetsSlice provides addAsset, removeAsset, updateAsset, getAsset, getAssetsByCategory
- Store type includes AssetsSlice
- Application compiles and runs without errors
</success_criteria>

<output>
After completion, create `.planning/phases/15-asset-library-storage-ui/15-01-SUMMARY.md`
</output>
