---
phase: 25-real-time-visualizations
plan: 04
type: execute
wave: 3
depends_on: ["25-02", "25-03"]
files_modified:
  - src/components/Properties/visualizations/ScrollingWaveformProperties.tsx
  - src/components/Properties/visualizations/SpectrumAnalyzerProperties.tsx
  - src/components/Properties/visualizations/SpectrogramProperties.tsx
  - src/components/Properties/visualizations/GoniometerProperties.tsx
  - src/components/Properties/visualizations/VectorscopeProperties.tsx
  - src/components/Properties/visualizations/index.ts
  - src/components/Properties/PropertyPanel.tsx
  - src/components/Palette/Palette.tsx
autonomous: true

must_haves:
  truths:
    - "Property panels allow configuring all visualization properties"
    - "Palette shows all 5 visualization types in appropriate category"
    - "Property panels render when visualization element is selected"
  artifacts:
    - path: "src/components/Properties/visualizations/ScrollingWaveformProperties.tsx"
      provides: "Property panel for scrolling waveform configuration"
      exports: ["ScrollingWaveformProperties"]
    - path: "src/components/Properties/visualizations/SpectrumAnalyzerProperties.tsx"
      provides: "Property panel for spectrum analyzer configuration"
      exports: ["SpectrumAnalyzerProperties"]
    - path: "src/components/Palette/Palette.tsx"
      provides: "Palette entries for all 5 visualization types"
      contains: "scrollingwaveform"
  key_links:
    - from: "src/components/Properties/PropertyPanel.tsx"
      to: "src/components/Properties/visualizations/"
      via: "propertyPanelRegistry import"
      pattern: "ScrollingWaveformProperties"
---

<objective>
Create property panels and palette entries for all 5 visualization element types.

Purpose: Enable users to configure visualization properties and add elements from palette.

Output: 5 property panel components, palette entries in "Visualizations" category.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/25-real-time-visualizations/25-CONTEXT.md
@.planning/phases/25-real-time-visualizations/25-02-SUMMARY.md
@.planning/phases/25-real-time-visualizations/25-03-SUMMARY.md
@src/components/Properties/PropertyPanel.tsx
@src/components/Properties/SpectrumAnalyzerProperties.tsx
@src/components/Palette/Palette.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create visualization property panels</name>
  <files>src/components/Properties/visualizations/ScrollingWaveformProperties.tsx, src/components/Properties/visualizations/SpectrumAnalyzerProperties.tsx, src/components/Properties/visualizations/SpectrogramProperties.tsx, src/components/Properties/visualizations/GoniometerProperties.tsx, src/components/Properties/visualizations/VectorscopeProperties.tsx, src/components/Properties/visualizations/index.ts</files>
  <action>
Create `src/components/Properties/visualizations/` directory with 5 property panel components.

**ScrollingWaveformProperties.tsx:**
```typescript
import { useElementsStore } from '../../../stores/useElementsStore'
import { PropertySection } from '../PropertySection'
import { ColorInput } from '../ColorInput'
import { NumberInput } from '../NumberInput'
import type { ScrollingWaveformElementConfig } from '../../../types/elements'

interface Props {
  config: ScrollingWaveformElementConfig
}

export function ScrollingWaveformProperties({ config }: Props) {
  const updateElement = useElementsStore(s => s.updateElement)

  const update = (changes: Partial<ScrollingWaveformElementConfig>) => {
    updateElement(config.id, changes)
  }

  return (
    <>
      <PropertySection title="Display">
        <label className="flex items-center justify-between">
          <span className="text-sm text-gray-300">Mode</span>
          <select
            value={config.displayMode}
            onChange={e => update({ displayMode: e.target.value as 'line' | 'fill' })}
            className="bg-gray-700 rounded px-2 py-1 text-sm"
          >
            <option value="line">Line</option>
            <option value="fill">Fill</option>
          </select>
        </label>
        <ColorInput label="Waveform Color" value={config.waveformColor} onChange={v => update({ waveformColor: v })} />
        <ColorInput label="Background" value={config.backgroundColor} onChange={v => update({ backgroundColor: v })} />
      </PropertySection>

      <PropertySection title="Grid">
        <label className="flex items-center gap-2">
          <input type="checkbox" checked={config.showGrid} onChange={e => update({ showGrid: e.target.checked })} />
          <span className="text-sm text-gray-300">Show Grid</span>
        </label>
        {config.showGrid && (
          <ColorInput label="Grid Color" value={config.gridColor} onChange={v => update({ gridColor: v })} />
        )}
      </PropertySection>

      <PropertySection title="Canvas">
        <NumberInput label="Scale Factor" value={config.canvasScale} min={1} max={4} step={0.5} onChange={v => update({ canvasScale: v })} />
      </PropertySection>
    </>
  )
}
```

**SpectrumAnalyzerProperties.tsx:**
- FFT Size dropdown: 512, 1024, 2048, 4096, 8192
- Frequency Scale dropdown: linear, log, mel
- Color Gradient dropdown: default, fire, cool, grayscale
- Bar Gap number input (0-4)
- Background Color picker
- Show Grid checkbox
- Grid Color picker (conditional)
- Show Frequency Labels checkbox
- Show dB Scale checkbox
- Canvas Scale factor

**SpectrogramProperties.tsx:**
- FFT Size dropdown
- Color Map dropdown: default, fire, cool, grayscale
- Background Color picker
- Show Frequency Labels checkbox
- Show Time Labels checkbox
- Canvas Scale factor

**GoniometerProperties.tsx:**
- Trace Color picker
- Background Color picker
- Show Grid checkbox
- Grid Color picker (conditional)
- Show Axis Lines checkbox
- Canvas Scale factor

**VectorscopeProperties.tsx:**
- Same as Goniometer (trace color, background, grid, axis lines, scale)

Create barrel export in `src/components/Properties/visualizations/index.ts`:
```typescript
export { ScrollingWaveformProperties } from './ScrollingWaveformProperties'
export { SpectrumAnalyzerProperties } from './SpectrumAnalyzerProperties'
export { SpectrogramProperties } from './SpectrogramProperties'
export { GoniometerProperties } from './GoniometerProperties'
export { VectorscopeProperties } from './VectorscopeProperties'
```
  </action>
  <verify>`ls src/components/Properties/visualizations/*.tsx | wc -l` shows 5 files</verify>
  <done>5 property panel components created with all configurable properties per type</done>
</task>

<task type="auto">
  <name>Task 2: Register property panels in PropertyPanel.tsx</name>
  <files>src/components/Properties/PropertyPanel.tsx</files>
  <action>
Update `src/components/Properties/PropertyPanel.tsx`:

1. Import visualization property panels:
```typescript
import {
  ScrollingWaveformProperties,
  SpectrumAnalyzerProperties,
  SpectrogramProperties,
  GoniometerProperties,
  VectorscopeProperties,
} from './visualizations'
```

2. Add to the switch statement or property panel registry (check existing pattern):
```typescript
case 'scrollingwaveform':
  return <ScrollingWaveformProperties config={element as ScrollingWaveformElementConfig} />
case 'spectrumanalyzer':
  return <SpectrumAnalyzerProperties config={element as SpectrumAnalyzerElementConfig} />
case 'spectrogram':
  return <SpectrogramProperties config={element as SpectrogramElementConfig} />
case 'goniometer':
  return <GoniometerProperties config={element as GoniometerElementConfig} />
case 'vectorscope':
  return <VectorscopeProperties config={element as VectorscopeElementConfig} />
```

If PropertyPanel uses a registry Map pattern, add entries to the Map instead.
  </action>
  <verify>`grep "scrollingwaveform" src/components/Properties/PropertyPanel.tsx` shows case or registry entry</verify>
  <done>Property panels registered and render when visualization elements are selected</done>
</task>

<task type="auto">
  <name>Task 3: Add palette entries for visualizations</name>
  <files>src/components/Palette/Palette.tsx</files>
  <action>
Update `src/components/Palette/Palette.tsx`:

Add new "Visualizations" category after "Audio Displays" (or wherever appropriate):

```typescript
{
  name: 'Visualizations',
  items: [
    { id: 'scrollingwaveform', type: 'scrollingwaveform', name: 'Scrolling Waveform' },
    { id: 'spectrumanalyzer', type: 'spectrumanalyzer', name: 'Spectrum Analyzer' },
    { id: 'spectrogram', type: 'spectrogram', name: 'Spectrogram' },
    { id: 'goniometer', type: 'goniometer', name: 'Goniometer' },
    { id: 'vectorscope', type: 'vectorscope', name: 'Vectorscope' },
  ],
},
```

Position the category near other audio-related categories (after "Audio Displays" or "Meters").
  </action>
  <verify>`grep "Visualizations" src/components/Palette/Palette.tsx` shows category name</verify>
  <done>Palette shows "Visualizations" category with all 5 element types</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes without errors
2. All 5 property panels exist with correct props
3. Selecting a visualization element shows its property panel
4. Palette shows "Visualizations" category with 5 items
5. Dragging from palette creates element on canvas
</verification>

<success_criteria>
- TypeScript compiles successfully
- Property panels expose all configurable properties per element type
- FFT Size, Frequency Scale, Color Gradient dropdowns work in Spectrum Analyzer
- Show Grid, Show Axis Lines toggles work in Goniometer/Vectorscope
- Canvas Scale factor configurable for all types
- Palette category appears with all 5 visualization types
- Elements can be added to canvas from palette
</success_criteria>

<output>
After completion, create `.planning/phases/25-real-time-visualizations/25-04-SUMMARY.md`
</output>
