---
phase: 23-professional-meters
plan: 05
type: execute
wave: 3
depends_on: ["23-02", "23-03", "23-04"]
files_modified:
  - src/components/Properties/meters/RMSMeterProperties.tsx
  - src/components/Properties/meters/VUMeterProperties.tsx
  - src/components/Properties/meters/PPMType1Properties.tsx
  - src/components/Properties/meters/PPMType2Properties.tsx
  - src/components/Properties/meters/TruePeakMeterProperties.tsx
  - src/components/Properties/meters/LUFSMomentaryProperties.tsx
  - src/components/Properties/meters/LUFSShorttermProperties.tsx
  - src/components/Properties/meters/LUFSIntegratedProperties.tsx
  - src/components/Properties/meters/KMeterProperties.tsx
  - src/components/Properties/meters/CorrelationMeterProperties.tsx
  - src/components/Properties/meters/StereoWidthMeterProperties.tsx
  - src/components/Properties/meters/index.ts
  - src/components/Properties/propertyPanelRegistry.ts
  - src/components/Palette/paletteConfig.ts
autonomous: true

must_haves:
  truths:
    - "Property panel shows meter-specific controls for all 24 meter types"
    - "User can configure orientation (vertical/horizontal) for level meters"
    - "User can configure scale position (outside/inside/none)"
    - "User can toggle peak hold on/off and configure hold duration"
    - "User can configure color zones with dB thresholds"
    - "All 24 meter types appear in Palette under Meters category"
  artifacts:
    - path: "src/components/Properties/meters/index.ts"
      provides: "Export all meter property panels"
      exports: ["RMSMeterProperties", "VUMeterProperties", "PPMType1Properties", "PPMType2Properties", "TruePeakMeterProperties", "LUFSMomentaryProperties", "LUFSShorttermProperties", "LUFSIntegratedProperties", "KMeterProperties", "CorrelationMeterProperties", "StereoWidthMeterProperties"]
    - path: "src/components/Properties/propertyPanelRegistry.ts"
      provides: "All 24 meter types registered"
      contains: "rmsmetermo|vumetermono|ppmtype1mono|k20meterstereo|correlationmeter"
    - path: "src/components/Palette/paletteConfig.ts"
      provides: "Meters category with all 24 element types"
      contains: "Meters|RMS Meter|VU Meter|PPM Type I"
  key_links:
    - from: "propertyPanelRegistry.ts"
      to: "meters/index.ts"
      via: "import property panels"
      pattern: "import.*from.*Properties/meters"
---

<objective>
Create property panels for all 24 professional meter element types and add them to the palette.

Purpose: Users need to configure meter properties (orientation, scale position, color zones, peak hold) through the property panel, and access all meter types from the palette.

Output: Property panels registered for all 24 meter types, palette entries under "Meters" category with subcategories for Level Meters, LUFS Meters, K-System, and Analysis.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-professional-meters/23-CONTEXT.md
@.planning/phases/23-professional-meters/23-02-SUMMARY.md
@.planning/phases/23-professional-meters/23-03-SUMMARY.md
@.planning/phases/23-professional-meters/23-04-SUMMARY.md
@src/components/Properties/propertyPanelRegistry.ts
@src/components/Palette/paletteConfig.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared meter property panel component</name>
  <files>
    src/components/Properties/meters/SharedMeterProperties.tsx
    src/components/Properties/meters/index.ts
  </files>
  <action>
Create a shared base component that handles common meter properties:

**SharedMeterProperties.tsx:**
```typescript
import React from 'react'
import { useStore } from '../../../store'
import { NumberInput, SelectInput, ToggleInput, ColorInput } from '../inputs'
import type { BaseProfessionalMeterConfig } from '../../../types/elements/displays'

interface SharedMeterPropertiesProps {
  elementId: string
  config: BaseProfessionalMeterConfig
  showOrientation?: boolean
  showChannelLabels?: boolean
  stereoChannelLabels?: boolean
  meterLabel: string
  minDbFixed?: boolean
  maxDbFixed?: boolean
}

export function SharedMeterProperties({
  elementId,
  config,
  showOrientation = true,
  showChannelLabels = false,
  stereoChannelLabels = false,
  meterLabel,
  minDbFixed = true,
  maxDbFixed = true,
}: SharedMeterPropertiesProps) {
  const updateElement = useStore((state) => state.updateElement)

  const update = (updates: Partial<BaseProfessionalMeterConfig>) => {
    updateElement(elementId, updates)
  }

  return (
    <div className="space-y-4">
      <div className="text-xs text-gray-400 uppercase tracking-wide">{meterLabel}</div>

      {/* Orientation */}
      {showOrientation && (
        <SelectInput
          label="Orientation"
          value={config.orientation}
          options={[
            { value: 'vertical', label: 'Vertical' },
            { value: 'horizontal', label: 'Horizontal' },
          ]}
          onChange={(v) => update({ orientation: v as 'vertical' | 'horizontal' })}
        />
      )}

      {/* Scale Position */}
      <SelectInput
        label="Scale Position"
        value={config.scalePosition}
        options={[
          { value: 'outside', label: 'Outside' },
          { value: 'inside', label: 'Inside' },
          { value: 'none', label: 'None' },
        ]}
        onChange={(v) => update({ scalePosition: v as 'outside' | 'inside' | 'none' })}
      />

      {/* Major/Minor Ticks */}
      <ToggleInput
        label="Major Ticks"
        checked={config.showMajorTicks}
        onChange={(v) => update({ showMajorTicks: v })}
      />
      <ToggleInput
        label="Minor Ticks"
        checked={config.showMinorTicks}
        onChange={(v) => update({ showMinorTicks: v })}
      />

      {/* Numeric Readout */}
      <ToggleInput
        label="Numeric Readout"
        checked={config.showNumericReadout}
        onChange={(v) => update({ showNumericReadout: v })}
      />

      {/* Segment Configuration */}
      <NumberInput
        label="Segment Count"
        value={config.segmentCount}
        min={10}
        max={100}
        step={1}
        onChange={(v) => update({ segmentCount: v })}
      />
      <NumberInput
        label="Segment Gap"
        value={config.segmentGap}
        min={0}
        max={4}
        step={1}
        onChange={(v) => update({ segmentGap: v })}
      />

      {/* dB Range (usually fixed per meter type) */}
      <div className="text-xs text-gray-500">
        Range: {config.minDb} dB to {config.maxDb > 0 ? '+' : ''}{config.maxDb} dB
      </div>

      {/* Peak Hold */}
      <div className="border-t border-gray-700 pt-4">
        <div className="text-xs text-gray-400 uppercase tracking-wide mb-2">Peak Hold</div>
        <ToggleInput
          label="Show Peak Hold"
          checked={config.showPeakHold}
          onChange={(v) => update({ showPeakHold: v })}
        />
        {config.showPeakHold && (
          <>
            <SelectInput
              label="Style"
              value={config.peakHoldStyle}
              options={[
                { value: 'line', label: 'Line' },
                { value: 'bar', label: 'Bar' },
              ]}
              onChange={(v) => update({ peakHoldStyle: v as 'line' | 'bar' })}
            />
            <NumberInput
              label="Hold Duration (ms)"
              value={config.peakHoldDuration}
              min={1000}
              max={5000}
              step={100}
              onChange={(v) => update({ peakHoldDuration: v })}
            />
          </>
        )}
      </div>

      {/* Channel Labels for stereo */}
      {showChannelLabels && stereoChannelLabels && (
        <ToggleInput
          label="Show Channel Labels"
          checked={(config as any).showChannelLabels}
          onChange={(v) => updateElement(elementId, { showChannelLabels: v })}
        />
      )}

      {/* Color Zones Editor would go here - can be added as enhancement */}
      <div className="text-xs text-gray-500 mt-4">
        Color zones: Green &lt;-18dB, Yellow -18 to -6dB, Red &ge;-6dB
      </div>
    </div>
  )
}
```

**index.ts:**
```typescript
export { SharedMeterProperties } from './SharedMeterProperties'
```
  </action>
  <verify>ls src/components/Properties/meters/SharedMeterProperties.tsx</verify>
  <done>Shared meter property component created with common controls for all professional meters</done>
</task>

<task type="auto">
  <name>Task 2: Create property panels for all meter types</name>
  <files>
    src/components/Properties/meters/RMSMeterProperties.tsx
    src/components/Properties/meters/VUMeterProperties.tsx
    src/components/Properties/meters/PPMType1Properties.tsx
    src/components/Properties/meters/PPMType2Properties.tsx
    src/components/Properties/meters/TruePeakMeterProperties.tsx
    src/components/Properties/meters/LUFSMomentaryProperties.tsx
    src/components/Properties/meters/LUFSShorttermProperties.tsx
    src/components/Properties/meters/LUFSIntegratedProperties.tsx
    src/components/Properties/meters/KMeterProperties.tsx
    src/components/Properties/meters/CorrelationMeterProperties.tsx
    src/components/Properties/meters/StereoWidthMeterProperties.tsx
    src/components/Properties/meters/index.ts
  </files>
  <action>
Create property panels for each meter type using SharedMeterProperties:

**RMSMeterProperties.tsx:**
```typescript
import React from 'react'
import { SharedMeterProperties } from './SharedMeterProperties'
import type { RMSMeterMonoElementConfig, RMSMeterStereoElementConfig } from '../../../types/elements/displays'

interface Props {
  element: RMSMeterMonoElementConfig | RMSMeterStereoElementConfig
}

export function RMSMeterProperties({ element }: Props) {
  const isStereo = element.type === 'rmsmeterstereo'

  return (
    <SharedMeterProperties
      elementId={element.id}
      config={element}
      meterLabel="RMS Meter"
      showOrientation={true}
      showChannelLabels={isStereo}
      stereoChannelLabels={isStereo}
    />
  )
}
```

Create similar panels for:
- VUMeterProperties.tsx (meterLabel: "VU Meter - ANSI C16.5-1942")
- PPMType1Properties.tsx (meterLabel: "PPM Type I (DIN)")
- PPMType2Properties.tsx (meterLabel: "PPM Type II (BBC)")
- TruePeakMeterProperties.tsx (meterLabel: "True Peak - ITU-R BS.1770-5")
- LUFSMomentaryProperties.tsx (meterLabel: "LUFS Momentary (400ms)")
- LUFSShorttermProperties.tsx (meterLabel: "LUFS Short-term (3s)")
- LUFSIntegratedProperties.tsx (meterLabel: "LUFS Integrated")
- KMeterProperties.tsx (handles K-12, K-14, K-20 based on element.kType)

**CorrelationMeterProperties.tsx:**
```typescript
import React from 'react'
import { useStore } from '../../../store'
import { ToggleInput, SelectInput, NumberInput } from '../inputs'
import type { CorrelationMeterElementConfig } from '../../../types/elements/displays'

interface Props {
  element: CorrelationMeterElementConfig
}

export function CorrelationMeterProperties({ element }: Props) {
  const updateElement = useStore((state) => state.updateElement)

  return (
    <div className="space-y-4">
      <div className="text-xs text-gray-400 uppercase tracking-wide">Correlation Meter</div>

      <NumberInput
        label="Bar Height"
        value={element.barHeight}
        min={8}
        max={24}
        step={2}
        onChange={(v) => updateElement(element.id, { barHeight: v })}
      />

      <ToggleInput
        label="Show Scale"
        checked={element.showScale}
        onChange={(v) => updateElement(element.id, { showScale: v })}
      />

      {element.showScale && (
        <SelectInput
          label="Scale Position"
          value={element.scalePosition}
          options={[
            { value: 'above', label: 'Above' },
            { value: 'below', label: 'Below' },
          ]}
          onChange={(v) => updateElement(element.id, { scalePosition: v as 'above' | 'below' })}
        />
      )}

      <ToggleInput
        label="Numeric Readout"
        checked={element.showNumericReadout}
        onChange={(v) => updateElement(element.id, { showNumericReadout: v })}
      />

      <div className="text-xs text-gray-500 mt-4">
        Range: -1 (out of phase) to +1 (in phase)
      </div>
    </div>
  )
}
```

**StereoWidthMeterProperties.tsx:**
Similar to CorrelationMeterProperties but with range note "0% (mono) to 200% (extra wide)"

**Update index.ts** to export all property panels:
```typescript
export { SharedMeterProperties } from './SharedMeterProperties'
export { RMSMeterProperties } from './RMSMeterProperties'
export { VUMeterProperties } from './VUMeterProperties'
export { PPMType1Properties } from './PPMType1Properties'
export { PPMType2Properties } from './PPMType2Properties'
export { TruePeakMeterProperties } from './TruePeakMeterProperties'
export { LUFSMomentaryProperties } from './LUFSMomentaryProperties'
export { LUFSShorttermProperties } from './LUFSShorttermProperties'
export { LUFSIntegratedProperties } from './LUFSIntegratedProperties'
export { KMeterProperties } from './KMeterProperties'
export { CorrelationMeterProperties } from './CorrelationMeterProperties'
export { StereoWidthMeterProperties } from './StereoWidthMeterProperties'
```
  </action>
  <verify>ls src/components/Properties/meters/*.tsx | wc -l</verify>
  <done>12 property panel files created (SharedMeterProperties + 11 meter-specific panels)</done>
</task>

<task type="auto">
  <name>Task 3: Register property panels and add palette entries</name>
  <files>
    src/components/Properties/propertyPanelRegistry.ts
    src/components/Palette/paletteConfig.ts
  </files>
  <action>
**Update propertyPanelRegistry.ts:**
Import all meter property panels and register them:

```typescript
import {
  RMSMeterProperties,
  VUMeterProperties,
  PPMType1Properties,
  PPMType2Properties,
  TruePeakMeterProperties,
  LUFSMomentaryProperties,
  LUFSShorttermProperties,
  LUFSIntegratedProperties,
  KMeterProperties,
  CorrelationMeterProperties,
  StereoWidthMeterProperties,
} from './meters'

// Add to registry Map - all 24 meter types
// RMS Meters
['rmsmetermo', RMSMeterProperties],
['rmsmeterstereo', RMSMeterProperties],

// VU Meters
['vumetermono', VUMeterProperties],
['vumeterstereo', VUMeterProperties],

// PPM Type I
['ppmtype1mono', PPMType1Properties],
['ppmtype1stereo', PPMType1Properties],

// PPM Type II
['ppmtype2mono', PPMType2Properties],
['ppmtype2stereo', PPMType2Properties],

// True Peak
['truepeakmetermono', TruePeakMeterProperties],
['truepeakmeterstereo', TruePeakMeterProperties],

// LUFS Momentary
['lufsmomomo', LUFSMomentaryProperties],
['lufsmomostereo', LUFSMomentaryProperties],

// LUFS Short-term
['lufsshortmono', LUFSShorttermProperties],
['lufsshortstereo', LUFSShorttermProperties],

// LUFS Integrated
['lufsintmono', LUFSIntegratedProperties],
['lufsintstereo', LUFSIntegratedProperties],

// K-System (all use same panel, it handles kType)
['k12metermono', KMeterProperties],
['k12meterstereo', KMeterProperties],
['k14metermono', KMeterProperties],
['k14meterstereo', KMeterProperties],
['k20metermono', KMeterProperties],
['k20meterstereo', KMeterProperties],

// Analysis Meters
['correlationmeter', CorrelationMeterProperties],
['stereowidthmeter', StereoWidthMeterProperties],
```

**Update paletteConfig.ts:**
Add Meters category with subcategories:

```typescript
{
  category: 'Meters',
  items: [
    // Level Meters
    { type: 'rmsmetermo', label: 'RMS Meter', icon: 'ðŸ“Š' },
    { type: 'rmsmeterstereo', label: 'RMS Meter (Stereo)', icon: 'ðŸ“Š' },
    { type: 'vumetermono', label: 'VU Meter', icon: 'ðŸ“Š' },
    { type: 'vumeterstereo', label: 'VU Meter (Stereo)', icon: 'ðŸ“Š' },
    { type: 'ppmtype1mono', label: 'PPM Type I', icon: 'ðŸ“Š' },
    { type: 'ppmtype1stereo', label: 'PPM Type I (Stereo)', icon: 'ðŸ“Š' },
    { type: 'ppmtype2mono', label: 'PPM Type II', icon: 'ðŸ“Š' },
    { type: 'ppmtype2stereo', label: 'PPM Type II (Stereo)', icon: 'ðŸ“Š' },
    { type: 'truepeakmetermono', label: 'True Peak', icon: 'ðŸ“Š' },
    { type: 'truepeakmeterstereo', label: 'True Peak (Stereo)', icon: 'ðŸ“Š' },

    // LUFS Meters
    { type: 'lufsmomomo', label: 'LUFS Momentary', icon: 'ðŸ“Š' },
    { type: 'lufsmomostereo', label: 'LUFS Momentary (Stereo)', icon: 'ðŸ“Š' },
    { type: 'lufsshortmono', label: 'LUFS Short-term', icon: 'ðŸ“Š' },
    { type: 'lufsshortstereo', label: 'LUFS Short-term (Stereo)', icon: 'ðŸ“Š' },
    { type: 'lufsintmono', label: 'LUFS Integrated', icon: 'ðŸ“Š' },
    { type: 'lufsintstereo', label: 'LUFS Integrated (Stereo)', icon: 'ðŸ“Š' },

    // K-System
    { type: 'k12metermono', label: 'K-12 Meter', icon: 'ðŸ“Š' },
    { type: 'k12meterstereo', label: 'K-12 Meter (Stereo)', icon: 'ðŸ“Š' },
    { type: 'k14metermono', label: 'K-14 Meter', icon: 'ðŸ“Š' },
    { type: 'k14meterstereo', label: 'K-14 Meter (Stereo)', icon: 'ðŸ“Š' },
    { type: 'k20metermono', label: 'K-20 Meter', icon: 'ðŸ“Š' },
    { type: 'k20meterstereo', label: 'K-20 Meter (Stereo)', icon: 'ðŸ“Š' },

    // Analysis
    { type: 'correlationmeter', label: 'Correlation Meter', icon: 'ðŸ“Š' },
    { type: 'stereowidthmeter', label: 'Stereo Width Meter', icon: 'ðŸ“Š' },
  ],
}
```

Note: Follow the existing palette structure pattern (check how other categories are defined). Use appropriate icons or fallback to emoji if needed.
  </action>
  <verify>grep -c "rmsmetermo\|correlationmeter" src/components/Properties/propertyPanelRegistry.ts src/components/Palette/paletteConfig.ts</verify>
  <done>All 24 meter types registered in property panel registry and palette config</done>
</task>

</tasks>

<verification>
1. `ls src/components/Properties/meters/*.tsx` - All property panel files exist
2. `grep "RMSMeterProperties" src/components/Properties/propertyPanelRegistry.ts` - Panels imported
3. `grep "rmsmetermo" src/components/Properties/propertyPanelRegistry.ts` - Types registered
4. `grep "Meters" src/components/Palette/paletteConfig.ts` - Category exists
5. `grep -c "type:" src/components/Palette/paletteConfig.ts | grep "24"` - 24 entries for meters
6. TypeScript compilation: `npx tsc --noEmit`
</verification>

<success_criteria>
- SharedMeterProperties handles common controls (orientation, scale, peak hold, segments)
- 11 meter-specific property panels created (handling mono/stereo variants)
- All 24 meter types registered in propertyPanelRegistry
- All 24 meter types appear in palette under Meters category
- Property panels show appropriate controls for each meter type
</success_criteria>

<output>
After completion, create `.planning/phases/23-professional-meters/23-05-SUMMARY.md`
</output>
