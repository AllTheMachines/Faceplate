---
phase: 13-extended-elements
plan: 13
type: execute
wave: 1
depends_on: []
files_modified:
  - src/App.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "User can drag TextField from palette and drop on canvas"
    - "User can drag Waveform Display from palette and drop on canvas"
    - "User can drag Oscilloscope from palette and drop on canvas"
    - "User can drag Preset Browser from palette and drop on canvas"
  artifacts:
    - path: "src/App.tsx"
      provides: "Complete handleDragEnd switch cases for all element types"
      contains: "createTextField"
  key_links:
    - from: "handleDragEnd switch"
      to: "createTextField"
      via: "case 'textfield'"
      pattern: "case 'textfield'.*createTextField"
    - from: "handleDragEnd switch"
      to: "createWaveform"
      via: "case 'waveform'"
      pattern: "case 'waveform'.*createWaveform"
    - from: "handleDragEnd switch"
      to: "createOscilloscope"
      via: "case 'oscilloscope'"
      pattern: "case 'oscilloscope'.*createOscilloscope"
    - from: "handleDragEnd switch"
      to: "createPresetBrowser"
      via: "case 'presetbrowser'"
      pattern: "case 'presetbrowser'.*createPresetBrowser"
---

<objective>
Add missing switch cases to App.tsx handleDragEnd for 4 element types

Purpose: TextField, Waveform, Oscilloscope, and PresetBrowser elements cannot be dropped on the canvas because their switch cases are missing from handleDragEnd. The factory functions exist but are not imported or called.

Output: All 4 element types can be dragged from palette and dropped on canvas to create new elements.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/13-extended-elements/13-UAT.md

Root cause from UAT diagnosis:
- App.tsx handleDragEnd (lines 156-218) has switch cases for most element types
- Missing cases: textfield, waveform, oscilloscope, presetbrowser
- Factory functions exist in src/types/elements.ts: createTextField, createWaveform, createOscilloscope, createPresetBrowser

Current imports in App.tsx (line 13-34) include many factory functions but miss the 4 needed ones.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add missing imports and switch cases</name>
  <files>src/App.tsx</files>
  <action>
1. Add the 4 missing factory function imports to the existing import block from './types/elements':
   - createTextField
   - createWaveform
   - createOscilloscope
   - createPresetBrowser

2. Add 4 switch cases in handleDragEnd (after the existing 'collapsible' case, before 'default'):

```tsx
case 'textfield':
  newElement = createTextField({ x: canvasX, y: canvasY, ...variant })
  break
case 'waveform':
  newElement = createWaveform({ x: canvasX, y: canvasY, ...variant })
  break
case 'oscilloscope':
  newElement = createOscilloscope({ x: canvasX, y: canvasY, ...variant })
  break
case 'presetbrowser':
  newElement = createPresetBrowser({ x: canvasX, y: canvasY, ...variant })
  break
```

Note: The elementType strings must match exactly what the Palette passes:
- 'textfield' (lowercase, no space)
- 'waveform' (lowercase)
- 'oscilloscope' (lowercase)
- 'presetbrowser' (lowercase, no space)

Keep all existing switch cases unchanged.
  </action>
  <verify>
1. `npm run build` completes without errors
2. Manual test: Drag TextField from palette, drop on canvas - element appears
3. Manual test: Drag Waveform Display from palette, drop on canvas - element appears
4. Manual test: Drag Oscilloscope from palette, drop on canvas - element appears
5. Manual test: Drag Preset Browser from palette, drop on canvas - element appears
  </verify>
  <done>All 4 element types can be dropped on canvas and appear at correct position</done>
</task>

</tasks>

<verification>
1. `npm run build` - No TypeScript errors
2. `npm run lint` - No ESLint errors
3. Manual verification:
   - Drag each of the 4 element types from palette to canvas
   - Each element appears at the mouse drop position
   - Elements can be selected and show correct properties
</verification>

<success_criteria>
- TextField can be dragged from palette and dropped on canvas
- Waveform Display can be dragged from palette and dropped on canvas
- Oscilloscope can be dragged from palette and dropped on canvas
- Preset Browser can be dragged from palette and dropped on canvas
- All created elements appear at correct canvas coordinates (accounting for pan/zoom)
- Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/13-extended-elements/13-13-SUMMARY.md`
</output>
