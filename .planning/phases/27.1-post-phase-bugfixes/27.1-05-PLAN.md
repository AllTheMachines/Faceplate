---
phase: 27.1-post-phase-bugfixes
plan: 05
type: execute
wave: 3
depends_on: ["27.1-03", "27.1-04"]
files_modified:
  - src/services/export/htmlGenerator.ts
  - src/services/export/cssGenerator.ts
autonomous: true

must_haves:
  truths:
    - "Spacers are intentionally invisible in HTML preview (design decision confirmed)"
    - "All exported elements have working interactivity via bindings.js"
  artifacts:
    - path: "src/services/export/htmlGenerator.ts"
      provides: "Spacer visibility documented, interactivity verified"
  key_links:
    - from: "bindings.js"
      to: "Interactive elements"
      via: "JUCE event listeners"
      pattern: "addEventListener|data-param"
---

<objective>
Investigate BUG-07 and BUG-11: Spacer visibility and element interactivity

**BUG-07 (Spacers not shown in preview):**
Spacers are layout elements. Need to determine if this is intentional (spacers are invisible by design - they create space but have no visual representation) or a bug. If intentional, document this. If a bug, add dashed border or other visual indicator in preview mode.

**BUG-11 (Elements have no interactivity):**
Need to investigate what level of interactivity is expected:
- Canvas elements: NOT interactive (design preview only) - correct behavior
- HTML preview: Should have working controls via mock JUCE backend
- Investigate if bindings.js is being generated correctly and if event listeners are attached

Purpose: Clarify spacer behavior and ensure HTML preview has working interactivity
Output: Documented spacer decision + verified interactive preview
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/services/export/htmlGenerator.ts
@src/services/export/jsGenerator.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify and document spacer behavior</name>
  <files>src/services/export/htmlGenerator.ts, src/services/export/cssGenerator.ts</files>
  <action>
Investigate spacer rendering in preview:

1. Check how SpacerRenderer renders on canvas - it shows a dashed border with size label for design visibility

2. Check the HTML/CSS export for spacers:
   - Do they generate HTML elements?
   - What CSS do they have?

3. Determine intended behavior:
   - **Option A (Intentional):** Spacers are pure layout elements that create space but have no visual representation in the final UI. In preview, they should be invisible (or show a very subtle indicator).
   - **Option B (Bug):** Spacers should show their designer indicator (dashed border) in preview for debugging.

**Decision:** Spacers should be INVISIBLE in HTML preview (they're layout aids, not visual elements). The designer shows them with dashed borders so users can see them, but the exported HTML should render them as invisible spacers.

If spacers currently don't render at all, add them with:
- display: block (or flex-grow for flexible spacers)
- background: transparent
- No visible content

If spacers render but are visible when they shouldn't be, remove visual styling.

Add code comment documenting this intentional behavior.
  </action>
  <verify>
1. Add Horizontal and Vertical Spacers to canvas
2. On canvas: spacers should show dashed border with dimension label
3. In Preview: spacers should be invisible but create correct space
4. Layout should be correct even though spacers are invisible
  </verify>
  <done>Spacer behavior documented: visible in designer, invisible in preview/export (intentional)</done>
</task>

<task type="auto">
  <name>Task 2: Investigate and fix element interactivity in preview</name>
  <files>src/services/export/jsGenerator.ts, src/services/export/htmlGenerator.ts</files>
  <action>
Investigate element interactivity in HTML preview:

1. Read jsGenerator.ts to understand:
   - generateBindingsJS: Creates JUCE parameter bindings
   - generateMockJUCE: Creates mock backend for preview mode
   - generateComponentsJS: Component initialization

2. Check that mock JUCE backend provides:
   - addEventListener for parameter updates
   - Methods to get/set parameter values
   - Event dispatch for value changes

3. Check HTML elements for required data attributes:
   - data-param-id: Links element to JUCE parameter
   - data-type: Element type for binding logic
   - Event listeners: mousedown, input, change events

4. Common interactivity issues:
   - Mock JUCE not initialized before bindings run
   - Data attributes missing from HTML
   - Event listeners not attached
   - CSS pointer-events: none blocking clicks

5. Test in browser dev tools:
   - Open preview
   - Check console for errors
   - Inspect elements for data attributes
   - Check if window.__JUCE__ exists

Fix any issues found. The preview should allow:
- Dragging knobs/sliders
- Clicking buttons
- Toggling switches
- Selecting from dropdowns
  </action>
  <verify>
1. Add Knob, Slider, Button to canvas
2. Open Preview
3. Drag Knob - value should change (visual rotation)
4. Drag Slider - thumb should move
5. Click Button - should show press state (momentary) or toggle state
6. Check browser console for any JavaScript errors
  </verify>
  <done>Elements in HTML preview respond to user interaction (drag, click, etc.)</done>
</task>

</tasks>

<verification>
1. Run `npm run dev`
2. Add spacers and interactive elements to canvas
3. Open Preview:
   - Spacers are invisible but create correct spacing
   - Knobs can be dragged and rotate visually
   - Sliders can be dragged
   - Buttons respond to clicks
4. No JavaScript errors in browser console
5. Mock JUCE backend functioning correctly
</verification>

<success_criteria>
- Spacers are invisible in preview (intentional, documented in code)
- Spacers still create correct layout spacing
- All control elements respond to user interaction in preview
- No JavaScript errors during interaction
- Mock JUCE backend properly simulates parameter updates
</success_criteria>

<output>
After completion, create `.planning/phases/27.1-post-phase-bugfixes/27.1-05-SUMMARY.md`
</output>
