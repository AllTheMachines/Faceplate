---
phase: 55-slider-styling
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/elements/controls.ts
  - src/components/elements/renderers/controls/SliderRenderer.tsx
  - src/components/Properties/SliderProperties.tsx
autonomous: true

must_haves:
  truths:
    - "Basic Slider config accepts styleId and colorOverrides properties"
    - "All linear slider configs accept styleId and colorOverrides properties"
    - "Basic Slider renders with SVG thumb/track/fill layers when styleId is set"
    - "Basic Slider renders with CSS when styleId is not set"
    - "Style dropdown appears in Basic Slider properties panel showing linear category styles"
  artifacts:
    - path: "src/types/elements/controls.ts"
      provides: "styleId and colorOverrides on all linear slider configs"
      contains: "styleId?: string"
    - path: "src/components/elements/renderers/controls/SliderRenderer.tsx"
      provides: "StyledSliderRenderer with SVG layer rendering"
      contains: "StyledSliderRenderer"
    - path: "src/components/Properties/SliderProperties.tsx"
      provides: "Style dropdown and color overrides for Pro users"
      contains: "getStylesByCategory"
  key_links:
    - from: "src/components/elements/renderers/controls/SliderRenderer.tsx"
      to: "useStore getElementStyle"
      via: "Zustand store selector"
      pattern: "getElementStyle"
    - from: "src/components/Properties/SliderProperties.tsx"
      to: "getStylesByCategory('linear')"
      via: "Store selector for style dropdown"
      pattern: "getStylesByCategory.*linear"
---

<objective>
Add SVG styling support to Basic Slider and prepare type foundation for all linear sliders.

Purpose: Establishes the pattern for linear slider SVG styling. Basic Slider is the simplest case - thumb translates, fill clips, track is static. This plan also updates ALL linear slider config types with styleId/colorOverrides so subsequent plans can focus purely on renderers and properties.

Output: Basic Slider renders with user-provided SVG layers when styleId is set. All 6 linear slider types have config types ready for styling.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/55-slider-styling/55-CONTEXT.md
@.planning/phases/55-slider-styling/55-RESEARCH.md
@.planning/phases/54-knob-variants/54-01-SUMMARY.md

# Key source files
@src/types/elements/controls.ts
@src/types/elementStyle.ts
@src/components/elements/renderers/controls/SliderRenderer.tsx
@src/components/elements/renderers/controls/SteppedKnobRenderer.tsx
@src/components/Properties/SliderProperties.tsx
@src/components/Properties/SteppedKnobProperties.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend all linear slider configs with styleId and colorOverrides</name>
  <files>src/types/elements/controls.ts</files>
  <action>
Add optional `styleId?: string` and `colorOverrides?: ColorOverrides` to ALL linear slider config interfaces:
- SliderElementConfig
- RangeSliderElementConfig
- MultiSliderElementConfig
- BipolarSliderElementConfig
- CrossfadeSliderElementConfig
- NotchedSliderElementConfig

Pattern from SteppedKnobElementConfig (lines 301-306):
```typescript
// SVG Style (optional - if undefined, render default CSS)
styleId?: string

// Per-instance color overrides (only used when styleId is set)
colorOverrides?: ColorOverrides
```

Import ColorOverrides from '../knobStyle' is already present at top of file.

Do NOT modify ArcSliderElementConfig yet - it uses 'arc' category (handled in Plan 06).
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>All 6 linear slider config interfaces include styleId and colorOverrides properties</done>
</task>

<task type="auto">
  <name>Task 2: Add StyledSliderRenderer to SliderRenderer.tsx</name>
  <files>src/components/elements/renderers/controls/SliderRenderer.tsx</files>
  <action>
Follow exact pattern from SteppedKnobRenderer.tsx:

1. Add imports at top:
```typescript
import { useMemo } from 'react'
import { useStore } from '../../../../store'
import { SafeSVG } from '../../../SafeSVG'
import { extractElementLayer } from '../../../../services/elementLayers'
import { applyAllColorOverrides } from '../../../../services/knobLayers'
```

2. Rename existing SliderRenderer to DefaultSliderRenderer (keep all code unchanged)

3. Create new StyledSliderRenderer function:
- Get style via `const getElementStyle = useStore((state) => state.getElementStyle)`
- Validate `style.category === 'linear'`
- Calculate normalizedValue: `(config.value - config.min) / (config.max - config.min)`
- Memoize svgContent with color overrides
- Extract layers: track, fill, thumb (from style.layers)
- Calculate thumb position based on orientation:
  - Horizontal: `translateX(${normalizedValue * (config.width - config.thumbWidth)}px)`
  - Vertical: `translateY(${(1 - normalizedValue) * (config.height - config.thumbHeight)}px)`
- Calculate fill clipPath based on orientation:
  - Horizontal: `inset(0 ${(1 - normalizedValue) * 100}% 0 0)`
  - Vertical: `inset(${(1 - normalizedValue) * 100}% 0 0 0)`
- Render layers: track (static), fill (clipped), thumb (translated)
- Include label and value displays using existing getLabelStyle/getValueStyle functions

4. Create new main export function SliderRenderer that delegates:
```typescript
export function SliderRenderer({ config }: SliderRendererProps) {
  if (!config.styleId) {
    return <DefaultSliderRenderer config={config} />
  }
  return <StyledSliderRenderer config={config} />
}
```

Key details:
- Use clip-path for fill (NOT scaleX - per RESEARCH.md recommendation)
- Add 0.05s ease-out transition on thumb transform and fill clipPath
- Handle "Style not found" fallback with grey background message
- Keep label/value rendering in StyledSliderRenderer (copy from DefaultSliderRenderer)
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit` and dev server starts: `npm run dev`</verify>
  <done>SliderRenderer delegates to Default or Styled based on styleId presence</done>
</task>

<task type="auto">
  <name>Task 3: Add style controls to SliderProperties</name>
  <files>src/components/Properties/SliderProperties.tsx</files>
  <action>
Follow exact pattern from SteppedKnobProperties.tsx:

1. Add imports:
```typescript
import { useStore } from '../../store'
import { useLicense } from '../../hooks/useLicense'
```

2. Inside SliderProperties function, add at the beginning:
```typescript
const { isPro } = useLicense()
const getStylesByCategory = useStore((state) => state.getStylesByCategory)
const linearStyles = getStylesByCategory('linear')
const currentStyle = config.styleId
  ? linearStyles.find(s => s.id === config.styleId)
  : undefined
```

3. Add style section at TOP of the properties (before Orientation):
```tsx
{/* Style Section */}
<div className="space-y-3">
  <h4 className="text-xs font-medium text-gray-400 uppercase tracking-wider">Style</h4>

  {/* Style Dropdown */}
  <div>
    <label className="block text-xs text-gray-400 mb-1">SVG Style</label>
    <select
      value={config.styleId || ''}
      onChange={(e) => updateElement(config.id, {
        styleId: e.target.value || undefined,
        colorOverrides: e.target.value ? config.colorOverrides : undefined
      })}
      className="w-full bg-gray-700 text-white text-sm rounded px-2 py-1.5 border border-gray-600"
      disabled={!isPro && linearStyles.length > 0}
    >
      <option value="">Default (CSS)</option>
      {linearStyles.map(style => (
        <option key={style.id} value={style.id}>{style.name}</option>
      ))}
    </select>
    {!isPro && linearStyles.length > 0 && (
      <p className="text-xs text-amber-500 mt-1">Pro license required for SVG styles</p>
    )}
  </div>

  {/* Color Overrides (only when style is selected) */}
  {currentStyle && isPro && (
    <div className="space-y-2">
      <label className="block text-xs text-gray-400">Color Overrides</label>
      {currentStyle.layers.thumb && (
        <ColorPicker
          label="Thumb"
          value={config.colorOverrides?.thumb || ''}
          onChange={(color) => updateElement(config.id, {
            colorOverrides: { ...config.colorOverrides, thumb: color || undefined }
          })}
        />
      )}
      {currentStyle.layers.track && (
        <ColorPicker
          label="Track"
          value={config.colorOverrides?.track || ''}
          onChange={(color) => updateElement(config.id, {
            colorOverrides: { ...config.colorOverrides, track: color || undefined }
          })}
        />
      )}
      {currentStyle.layers.fill && (
        <ColorPicker
          label="Fill"
          value={config.colorOverrides?.fill || ''}
          onChange={(color) => updateElement(config.id, {
            colorOverrides: { ...config.colorOverrides, fill: color || undefined }
          })}
        />
      )}
    </div>
  )}
</div>
```

Import ColorPicker if not already present:
```typescript
import { ColorPicker } from './shared/ColorPicker'
```
  </action>
  <verify>Dev server runs without errors, style dropdown visible in Slider properties panel</verify>
  <done>Basic Slider properties panel shows style dropdown for linear styles and color overrides</done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npx tsc --noEmit`
2. Dev server starts: `npm run dev`
3. Add a Basic Slider to canvas - should render with CSS (default)
4. If linear styles exist, dropdown shows them
5. If no styleId set, slider renders as before (CSS rectangles)
</verification>

<success_criteria>
- All 6 linear slider configs have styleId and colorOverrides properties
- Basic Slider renders with SVG layers when styleId is set
- Basic Slider renders with CSS when no styleId (unchanged behavior)
- Style dropdown appears in properties panel
- Color overrides work when style is selected (Pro only)
</success_criteria>

<output>
After completion, create `.planning/phases/55-slider-styling/55-01-SUMMARY.md`
</output>
