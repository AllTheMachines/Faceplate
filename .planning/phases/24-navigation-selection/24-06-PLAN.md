---
phase: 24-navigation-selection
plan: 06
type: execute
wave: 2
depends_on: ["24-01", "24-02", "24-03", "24-04"]
files_modified:
  - src/services/export/cssGenerator.ts
  - src/services/export/htmlGenerator.ts
autonomous: true

must_haves:
  truths:
    - "Exported CSS includes styles for all 8 navigation element types"
    - "Exported HTML renders all 8 navigation elements with proper structure"
    - "Tab Bar exports with data-active-tab attribute for JUCE binding"
    - "Stepper exports with data-value, data-min, data-max, data-step attributes"
    - "Tree View exports with data-selected-id attribute for JUCE binding"
  artifacts:
    - path: "src/services/export/cssGenerator.ts"
      provides: "CSS generation for navigation elements"
      contains: "stepper|tabbar|treeview"
    - path: "src/services/export/htmlGenerator.ts"
      provides: "HTML generation for navigation elements"
      contains: "stepper|tabbar|treeview|data-active-tab"
  key_links:
    - from: "cssGenerator.ts"
      to: "controls.ts"
      via: "type imports"
      pattern: "import.*StepperElementConfig"
    - from: "htmlGenerator.ts"
      to: "controls.ts"
      via: "type imports"
      pattern: "import.*TabBarElementConfig"
---

<objective>
Add export support (CSS and HTML generation) for all 8 navigation element types.

Purpose: Exported JUCE bundles must include CSS for navigation element styling and HTML structure with data attributes that JUCE can query and update at runtime.

Output: CSS and HTML generators handle all 8 navigation element types with appropriate styles, data attributes, and JUCE integration points.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-navigation-selection/24-CONTEXT.md
@.planning/phases/24-navigation-selection/24-01-SUMMARY.md
@.planning/phases/24-navigation-selection/24-02-SUMMARY.md
@.planning/phases/24-navigation-selection/24-03-SUMMARY.md
@.planning/phases/24-navigation-selection/24-04-SUMMARY.md
@src/services/export/cssGenerator.ts
@src/services/export/htmlGenerator.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CSS generation for navigation elements</name>
  <files>src/services/export/cssGenerator.ts</files>
  <action>
Add CSS generation cases for all 8 navigation element types in cssGenerator.ts.

Add helper functions and case handlers for each element type:

**Stepper CSS:**
```typescript
function generateStepperCSS(element: StepperElementConfig, selector: string): string {
  const isHorizontal = element.orientation === 'horizontal'
  return `
${selector} {
  display: flex;
  flex-direction: ${isHorizontal ? 'row' : 'column'};
  background-color: ${element.backgroundColor};
  border-radius: ${element.borderRadius}px;
  overflow: hidden;
}

${selector} .stepper-button {
  width: ${isHorizontal ? element.buttonSize + 'px' : '100%'};
  height: ${isHorizontal ? '100%' : element.buttonSize + 'px'};
  background-color: ${element.buttonColor};
  color: ${element.textColor};
  border: none;
  cursor: pointer;
  font-size: 16px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: none;
}

${selector} .stepper-value {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  color: ${element.textColor};
  font-size: 14px;
  font-family: Inter, system-ui, sans-serif;
}
`
}
```

**Breadcrumb CSS:**
```typescript
function generateBreadcrumbCSS(element: BreadcrumbElementConfig, selector: string): string {
  return `
${selector} {
  display: flex;
  align-items: center;
}

${selector} ol {
  display: flex;
  list-style: none;
  padding: 0;
  margin: 0;
  align-items: center;
}

${selector} a {
  color: ${element.linkColor};
  text-decoration: none;
  font-size: ${element.fontSize}px;
}

${selector} a:hover {
  color: ${element.hoverColor};
}

${selector} .breadcrumb-current {
  color: ${element.currentColor};
  font-size: ${element.fontSize}px;
}

${selector} .breadcrumb-separator {
  margin: 0 6px;
  color: ${element.separatorColor};
  font-size: ${element.fontSize}px;
}
`
}
```

**Dropdown CSS (shared pattern for MultiSelect, ComboBox, MenuButton):**
```typescript
function generateDropdownBaseCSS(selector: string, bgColor: string, textColor: string, borderColor: string, borderRadius: number): string {
  return `
${selector} {
  position: relative;
}

${selector} .dropdown-trigger {
  width: 100%;
  height: 100%;
  background-color: ${bgColor};
  color: ${textColor};
  border: 1px solid ${borderColor};
  border-radius: ${borderRadius}px;
  padding: 0 8px;
  text-align: left;
  cursor: pointer;
}

${selector} .dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
  background-color: ${bgColor};
  border: 1px solid ${borderColor};
  border-radius: ${borderRadius}px;
  margin-top: 4px;
  z-index: 1000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 100ms ease-out;
}

${selector}.open .dropdown-menu {
  opacity: 1;
  pointer-events: auto;
}
`
}
```

**Tab Bar CSS:**
```typescript
function generateTabBarCSS(element: TabBarElementConfig, selector: string): string {
  const isHorizontal = element.orientation === 'horizontal'
  return `
${selector} {
  display: flex;
  flex-direction: ${isHorizontal ? 'row' : 'column'};
  background-color: ${element.backgroundColor};
  border-radius: 4px;
  overflow: hidden;
}

${selector} .tab {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  height: ${isHorizontal ? '100%' : element.tabHeight + 'px'};
  padding: 0 12px;
  border: none;
  background-color: ${element.inactiveTabColor};
  color: ${element.textColor};
  cursor: pointer;
  position: relative;
  transition: none;
}

${selector} .tab.active {
  background-color: ${element.indicatorStyle === 'background' ? element.activeTabColor : element.inactiveTabColor};
  color: ${element.activeTextColor};
}

${selector} .tab.active .tab-indicator-underline {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background-color: ${element.indicatorColor};
}

${selector} .tab.active .tab-indicator-bar {
  position: absolute;
  left: 0;
  top: 25%;
  bottom: 25%;
  width: 3px;
  background-color: ${element.indicatorColor};
  border-radius: 2px;
}
`
}
```

**Tag Selector CSS:**
```typescript
function generateTagSelectorCSS(element: TagSelectorElementConfig, selector: string): string {
  return `
${selector} {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

${selector} .tags-container {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

${selector} .tag-chip {
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: ${element.chipBackgroundColor};
  border-radius: ${element.chipBorderRadius}px;
  color: ${element.chipTextColor};
  font-size: 12px;
}

${selector} .tag-remove {
  margin-left: 6px;
  background: transparent;
  border: none;
  cursor: pointer;
  color: ${element.removeButtonColor};
  padding: 0;
  font-size: 14px;
  line-height: 1;
}

${selector} .tag-input {
  width: 100%;
  padding: 6px 8px;
  background-color: ${element.inputBackgroundColor};
  color: ${element.inputTextColor};
  border: 1px solid ${element.inputBorderColor};
  border-radius: ${element.chipBorderRadius}px;
  box-sizing: border-box;
}
`
}
```

**Tree View CSS:**
```typescript
function generateTreeViewCSS(element: TreeViewElementConfig, selector: string): string {
  return `
${selector} {
  background-color: ${element.backgroundColor};
  overflow: auto;
  border-radius: 4px;
}

${selector} .tree-node {
  display: flex;
  align-items: center;
  height: ${element.rowHeight}px;
  padding-right: 8px;
  cursor: pointer;
  color: ${element.textColor};
  transition: none;
}

${selector} .tree-node:hover {
  background-color: ${element.hoverBackgroundColor};
}

${selector} .tree-node.selected {
  background-color: ${element.selectedBackgroundColor};
  color: ${element.selectedTextColor};
}

${selector} .tree-arrow {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: ${element.arrowColor};
  user-select: none;
}

${selector} .tree-node-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 13px;
}
`
}
```

Add cases in the main switch/map for generating CSS.
  </action>
  <verify>grep -c "stepper\|tabbar\|treeview\|breadcrumb" src/services/export/cssGenerator.ts shows 4+ matches</verify>
  <done>CSS generation added for all 8 navigation element types</done>
</task>

<task type="auto">
  <name>Task 2: Add HTML generation for navigation elements</name>
  <files>src/services/export/htmlGenerator.ts</files>
  <action>
Add HTML generation cases for all 8 navigation element types in htmlGenerator.ts.

**Stepper HTML:**
```typescript
function generateStepperHTML(element: StepperElementConfig): string {
  const valueDisplay = element.showValue
    ? `<div class="stepper-value">${element.decimalPlaces > 0 ? element.value.toFixed(element.decimalPlaces) : element.value}${element.valueSuffix}</div>`
    : ''

  return `
<div class="element stepper" id="${element.id}" data-value="${element.value}" data-min="${element.min}" data-max="${element.max}" data-step="${element.step}">
  <button class="stepper-button decrement">-</button>
  ${valueDisplay}
  <button class="stepper-button increment">+</button>
</div>`
}
```

**Breadcrumb HTML:**
```typescript
function generateBreadcrumbHTML(element: BreadcrumbElementConfig): string {
  const items = element.items.map((item, index) => {
    const isLast = index === element.items.length - 1
    const separator = !isLast ? `<span class="breadcrumb-separator">${element.separator}</span>` : ''

    if (isLast) {
      return `<li><span class="breadcrumb-current" aria-current="page">${item.label}</span></li>`
    }
    return `<li><a href="#" data-item-id="${item.id}">${item.label}</a>${separator}</li>`
  }).join('')

  return `
<nav class="element breadcrumb" id="${element.id}" aria-label="breadcrumb">
  <ol>${items}</ol>
</nav>`
}
```

**Multi-Select Dropdown HTML:**
```typescript
function generateMultiSelectDropdownHTML(element: MultiSelectDropdownElementConfig): string {
  const selectedText = element.selectedIndices.length > 0
    ? element.selectedIndices.map(i => element.options[i]).join(', ')
    : 'Select...'

  const optionItems = element.options.map((opt, i) => {
    const checked = element.selectedIndices.includes(i) ? 'checked' : ''
    return `<div class="dropdown-item" data-index="${i}"><input type="checkbox" ${checked}><span>${opt}</span></div>`
  }).join('')

  return `
<div class="element multiselectdropdown" id="${element.id}" data-max-selections="${element.maxSelections}">
  <button class="dropdown-trigger">${selectedText}</button>
  <div class="dropdown-menu" role="listbox" aria-multiselectable="true">${optionItems}</div>
</div>`
}
```

**Combo Box HTML:**
```typescript
function generateComboBoxHTML(element: ComboBoxElementConfig): string {
  const optionItems = element.options.map(opt =>
    `<li class="dropdown-item" role="option">${opt}</li>`
  ).join('')

  return `
<div class="element combobox" id="${element.id}" role="combobox" aria-expanded="false">
  <input type="text" value="${element.selectedValue}" placeholder="${element.placeholder}" aria-autocomplete="list">
  <ul class="dropdown-menu" role="listbox">${optionItems}</ul>
</div>`
}
```

**Menu Button HTML:**
```typescript
function generateMenuButtonHTML(element: MenuButtonElementConfig): string {
  const menuItems = element.menuItems.map(item => {
    if (item.divider) {
      return `<div class="menu-divider"></div>`
    }
    return `<button class="menu-item" role="menuitem" data-item-id="${item.id}" ${item.disabled ? 'disabled' : ''}>${item.label}</button>`
  }).join('')

  return `
<div class="element menubutton" id="${element.id}">
  <button class="dropdown-trigger" aria-haspopup="menu" aria-expanded="false">${element.label}</button>
  <div class="dropdown-menu" role="menu">${menuItems}</div>
</div>`
}
```

**Tab Bar HTML:**
```typescript
function generateTabBarHTML(element: TabBarElementConfig): string {
  const tabs = element.tabs.map((tab, index) => {
    const isActive = index === element.activeTabIndex
    const activeClass = isActive ? 'active' : ''
    const iconHtml = tab.showIcon && tab.icon ? `<span class="tab-icon">${getBuiltInIconSVG(tab.icon)}</span>` : ''
    const labelHtml = tab.showLabel && tab.label ? `<span class="tab-label">${tab.label}</span>` : ''
    const indicator = isActive && element.indicatorStyle === 'underline'
      ? '<div class="tab-indicator-underline"></div>'
      : isActive && element.indicatorStyle === 'accent-bar'
        ? '<div class="tab-indicator-bar"></div>'
        : ''

    return `<button class="tab ${activeClass}" role="tab" aria-selected="${isActive}" data-tab-index="${index}">${iconHtml}${labelHtml}${indicator}</button>`
  }).join('')

  return `
<div class="element tabbar" id="${element.id}" role="tablist" data-active-tab="${element.activeTabIndex}">
  ${tabs}
</div>`
}
```

**Tag Selector HTML:**
```typescript
function generateTagSelectorHTML(element: TagSelectorElementConfig): string {
  const tagChips = element.selectedTags.map(tag =>
    `<div class="tag-chip" data-tag-id="${tag.id}"><span>${tag.label}</span><button class="tag-remove" aria-label="Remove ${tag.label}">&times;</button></div>`
  ).join('')

  const inputHtml = element.showInput
    ? `<input type="text" class="tag-input" placeholder="${element.inputPlaceholder}">`
    : ''

  return `
<div class="element tagselector" id="${element.id}" role="list" aria-label="Selected tags">
  <div class="tags-container">${tagChips}</div>
  ${inputHtml}
</div>`
}
```

**Tree View HTML:**
```typescript
function generateTreeNodeHTML(node: TreeNode, indent: number, indentPx: number, selectedId?: string): string {
  const hasChildren = node.children && node.children.length > 0
  const isSelected = node.id === selectedId
  const selectedClass = isSelected ? 'selected' : ''
  const arrow = hasChildren ? '<span class="tree-arrow">&#9654;</span>' : '<span class="tree-arrow"></span>'
  const paddingLeft = indent * indentPx

  let childrenHtml = ''
  if (hasChildren && node.children) {
    childrenHtml = node.children.map(child =>
      generateTreeNodeHTML(child, indent + 1, indentPx, selectedId)
    ).join('')
  }

  return `
<div class="tree-node ${selectedClass}" data-node-id="${node.id}" style="padding-left: ${paddingLeft}px">
  ${arrow}
  <span class="tree-node-name">${node.name}</span>
</div>
${childrenHtml}`
}

function generateTreeViewHTML(element: TreeViewElementConfig): string {
  const nodesHtml = element.data.map(node =>
    generateTreeNodeHTML(node, 0, element.indent, element.selectedId)
  ).join('')

  return `
<div class="element treeview" id="${element.id}" data-selected-id="${element.selectedId || ''}">
  ${nodesHtml}
</div>`
}
```

Add cases in the main switch/map for generating HTML.
  </action>
  <verify>grep -c "data-active-tab\|data-value.*data-min\|data-selected-id" src/services/export/htmlGenerator.ts shows 3+ matches</verify>
  <done>HTML generation added for all 8 navigation element types with JUCE data attributes</done>
</task>

</tasks>

<verification>
1. `grep "stepper" src/services/export/cssGenerator.ts` - CSS handler exists
2. `grep "tabbar" src/services/export/cssGenerator.ts` - CSS handler exists
3. `grep "treeview" src/services/export/cssGenerator.ts` - CSS handler exists
4. `grep "data-active-tab" src/services/export/htmlGenerator.ts` - Tab Bar data attribute
5. `grep "data-value.*data-min" src/services/export/htmlGenerator.ts` - Stepper data attributes
6. `grep "data-selected-id" src/services/export/htmlGenerator.ts` - Tree View data attribute
7. TypeScript compilation: `npx tsc --noEmit`
</verification>

<success_criteria>
- CSS generators output styles for all 8 navigation element types
- Dropdown elements have 100ms fade-in, 150ms fade-out CSS transitions
- Tab Bar CSS includes indicator styles (background, underline, accent-bar)
- Tree View CSS handles node selection and hover states
- HTML generators output proper structure with data attributes for JUCE
- Stepper outputs data-value, data-min, data-max, data-step
- Tab Bar outputs data-active-tab
- Tree View outputs data-selected-id and data-node-id
- All elements include ARIA attributes for accessibility
</success_criteria>

<output>
After completion, create `.planning/phases/24-navigation-selection/24-06-SUMMARY.md`
</output>
